<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authors</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Authors</h1>
    <ul id="authors-list">
    </ul>
    <button onclick="window.location.href='/'">Back to Home</button>
    <button onclick="showAddAuthorForm()">Add Author</button>

    <div id="add-author-form" style="display: none;">
        <h2>Add New Author</h2>
        <form id="author-form">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required>
            <br>
            <label for="date_of_birth">Date of Birth:</label>
            <input type="date" id="date_of_birth" name="date_of_birth">
            <br>
            <label for="country_of_origin">Country of Origin:</label>
            <input type="text" id="country_of_origin" name="country_of_origin" required>
            <br>
            <label for="short_description">Short Description:</label>
            <textarea id="short_description" name="short_description" required></textarea>
            <br>
            <button type="submit">Submit</button>
        </form>
    </div>

    <script>
        async function fetchAuthors() {
            const response = await fetch('/api/authors');
            const authors = await response.json();
            const authorsList = document.getElementById('authors-list');
            authors.forEach(author => {
                const listItem = document.createElement('li');
                listItem.textContent = `${author.name} (${author.date_of_birth} - ${author.country_of_origin})`;
                authorsList.appendChild(listItem);
            });
        }

        function showAddAuthorForm() {
            document.getElementById('add-author-form').style.display = 'block';
        }

        document.getElementById('author-form').addEventListener('submit', async (event) => {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());

            const response = await fetch('/api/authors', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                alert('Author added successfully!');
                window.location.reload();
            } else {
                alert('Error adding author');
            }
        });

        fetchAuthors();
    </script>
</body>
</html>
